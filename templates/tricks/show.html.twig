{% extends 'base.html.twig' %}

{% block body %}
    {% for comment in tricks.comments %}
        <p>{{ comment.content }}
            {% if is_granted('COMMENT_ACCESS', comment) %}
                <button data-toggle="modal" data-target="#editCommentModal" data-comment-id="{{ comment.id }}" data-tricks-slug="{{ tricks.slug }}" class="edit-button"><i class="bi-pencil-fill text-primary"></i></button>
                <form method="POST"
                      action="{{ path('app_tricks_deleteComment', {id: comment.id, slug: tricks.slug}) }}"
                      onsubmit="return confirm('{% trans %}Are you really sure you want to delete this comment?{% endtrans %}')">
                    <input type="hidden" name="_method" value="DELETE">
                    <input type="hidden" name="_token" id="csrf_token[{{ comment.id }}]"
                           value="{{ csrf_token('delete-comment-' ~ comment.id) }}">
                    <button type="submit" class="button-no-decoration">
                        <i class="bi bi-trash-fill text-danger p-1"></i>
                    </button>
                </form>
            {% endif %}
        </p>
    {% endfor %}
    <div class="modal" tabindex="-1" role="dialog" id="editCommentModal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Modifier le commentaire</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="editCommentModalBody"></div>
                </div>
            </div>
        </div>
    </div>
    {% if app.user %}
        <a href="{{ path('app_tricks_edit', {slug: tricks.slug}) }}">edit</a>
        <form method="POST"
              action="{{ path('app_tricks_delete', {slug: tricks.slug}) }}"
              onsubmit="return confirm('{% trans %}Are you really sure you want to delete this tricks?{% endtrans %}')">
            <input type="hidden" name="_method" value="DELETE">
            <input type="hidden" name="_token" id="csrf_token[{{ tricks.slug }}]"
                   value="{{ csrf_token('delete-tricks-' ~ tricks.slug) }}">
            <button type="submit" class="button-no-decoration">
                <i class="bi bi-trash-fill text-danger p-1"></i>
            </button>
        </form>
        {{ include('comment/_form.html.twig') }}
    {% else %}
        Pour pouvoir laisser un commentaire merci de vous connecter !
    {% endif %}
{% endblock %}

{% block title %}
    {{ tricks }}
{% endblock %}

{% block importmap %}
    {{ importmap('comment-edit') }}
{% endblock %}
